<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>可持续性评价</title>

<script src="js/jquery.min.js"></script>

</head>
<body>
<h2>可持续性评价</h2>
<hr />
<div style="margin: 10px;">
	<input type="hidden" id="input_para_1" value="3ec75f9d-a1aa-4455-a753-e8fc50f188c8" readonly="true"/>
	<input type="hidden" id="availableyear" readonly="true"/>
	<button id="input_btn">输入数据</button>
	<button id="query_btn">查询状态</button>
	<button id="queryyears_btn" disabled="true">查询可获取年份列表</button>
	<button id="calculate" disabled="true">计算指标</button>
	<button id="clear">清屏</button>
</div>
<div id="bigtext" style="height: 300px; width: 400px; font-family: '微软雅黑' ;">
</div>
<!--<div style="margin: 10px;">
	查询状态：
	<button id="query_btn">查询</button>
	<input type="text" id="query_return" />
</div>
<div style="margin: 10px;">
	输出参数：
	<button id="output_btn">输出</button>
	<input type="text" id="output_return" />-->
</div>
</body>
<script>
	
	$("#clear").on("click",function(){
		$("#bigtext").empty();
	});
	
	$("#input_btn").on("click",function(){
		$("#input_btn").attr("disabled","true");
		$("#bigtext").append("<p>正在传入参数……</p>");
		
		$.post(
			"test.do",
			{
				"projectId":document.getElementById("input_para_1").value,
			},function(data){
				$("#bigtext").append("<p>"+data+"</p>");
			}
		);
	});
	
	$("#query_btn").on("click",function(){
		$("#bigtext").append("<p>正在查询模型状态……</p>");
		$.post(
			"queryStatews.do",
			[],
			function(data){
				switch(data){
				case(1):
					$("#bigtext").append("<p>成功，模型状态为1-ready</p>");
					break;
				case(2):
					$("#bigtext").append("<p>成功，模型状态为2-running</p>");
					break;
				case(3):
					$("#bigtext").append("<p>成功，模型状态为3-accessible</p>");
					$("#queryyears_btn").attr("disabled",false);
					break;
				case(4):
					$("#bigtext").append("<p>成功，模型状态为4-finished</p>");
					break;
				default:
					$("#bigtext").append("<p>失败，请检查</p>");
				}
			}
		)
	});

	$("#queryyears_btn").on("click",function(){
		$("#bigtext").append("<p>正在查询可获取数据年份……</p>");
		$.post(
				"queryAvailablews.do",
				[],
				function(data){
					if(data.length<1){
						$("#bigtext").append("<p>无可用年份</p>");
					}else{
						$("#bigtext").append("<p>"+"可用年份："+JSON.stringify(data)+"</p>");
						$("#availableyear").val(data);
						$("#calculate").attr("disabled",false);
					}
				}
			)	
	})
	
	$("#calculate").on("click",function(){
		$.post(
			"getDataYearlyws.do",
			{
				"year":parseInt("2000")
			},function(data){
				if(data=="数据已提交给指标计算模型！"){
					$("button").attr("disabled","true");
					$("#bigtext").append("<p>"+data+"&nbsp 3秒后跳转……</p>");
					setInterval("window.location='GIS.html'",3000);
				}else{
					$("#bigtext").append("<p>"+data+"</p>");
				}
			}
		)
	})
</script>
